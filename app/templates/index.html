{% extends "base.html" %}

{% block content %}
<div class="hero">
    {% if user %}
        <h2>Benvenuto, {{ user.username }}!</h2>
        <p>Gestione Corse Podistiche</p>
        <div class="hero-actions">
            <a href="{{ url_for('main.create_race') }}" class="btn btn-primary">âž• Crea una Gara</a>
        </div>
    {% else %}
        <h2>Benvenuto</h2>
        <p><a href="{{ url_for('main.login') }}">Accedi</a> per continuare</p>
    {% endif %}
</div>

<section class="races-section container">
    <div class="filter-box">
        <input id="race-filter" type="search" placeholder="Filtra per nome, luogo o autore..." aria-label="Filtra corse">
    </div>
    <h3 class="section-title">Corse registrate</h3>
    {% if races and races|length > 0 %}
        <ul class="race-list">
            {% for race in races %}
                <li class="race-item">
                    <a href="{{ url_for('main.race_detail', race_id=race.id) }}" class="race-link">
                        <div class="race-main">
                            <div>
                                <strong class="race-name">{{ race.name }}</strong>
                                <div class="race-meta">Creato da {{ race.creator.username }} - {{ race.created_at.strftime('%d/%m/%Y') }}</div>
                            </div>
                            <div class="race-side">
                                {% if race.average_rating is not none %}
                                    <div class="race-average">ðŸš© {{ race.average_rating|round(1) }}/5</div>
                                    <div class="race-count">({{ race.reviews_count }} recensioni)</div>
                                {% else %}
                                    <div class="race-average no-reviews">Nessuna recensione</div>
                                {% endif %}
                            </div>
                        </div>
                    </a>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="info">Nessuna gara presente. Crea la prima!</p>
    {% endif %}
</section>

{% endblock %}
